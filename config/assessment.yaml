# Assessment Configuration
# ========================
# Domain-agnostic settings for fault/regime detection
# Each domain can override these defaults

defaults:
  # Window sizes (days)
  windows:
    pre_onset: 7          # Days before event to analyze
    post_onset: 5         # Days after event to analyze
    mode1_lookback: 7     # Days to check for precursor mode

  # Detection thresholds
  thresholds:
    break_zscore: 1.0     # Z-score threshold for break detection
    affinity_drop: 0.1    # Affinity drop threshold for warning
    mode_entropy_spike: 0.5  # Entropy spike threshold

  # Feature groups for each detection layer
  what_features:          # Classification features
    - alpha
    - beta
    - omega
    - unconditional_vol
    - spectral_slope
    - spectral_entropy
    - permutation_entropy
    - sample_entropy

  when_features:          # Break detection features
    - break_n
    - break_rate
    - break_is_accelerating
    - dirac_n_impulses
    - dirac_mean_magnitude
    - heaviside_n_steps
    - heaviside_mean_magnitude

  mode_features:          # Mode clustering features (Laplace fingerprints)
    - gradient_mean
    - gradient_std
    - gradient_magnitude
    - laplacian_mean
    - laplacian_std
    - divergence

  # Mode clustering
  mode_clustering:
    n_components: 5       # Number of modes to discover
    precursor_mode: 1     # Which mode ID is the precursor (discovered empirically)
    sample_dates: 50      # Dates to sample for mode computation (memory management)

# Domain-specific overrides
domains:
  cheme:
    description: "Tennessee Eastman Process (TEP)"
    signal_prefix: "TEP_"
    fault_signal: "TEP_FAULT"
    exclude_pattern: "FAULT"  # Exclude fault label from analysis

    # TEP-specific: Mode 1 dominated by XMEAS03 (D Feed)
    precursor_signals:
      - "TEP_XMEAS03"     # D Feed - upstream reactor input

    # Override defaults if needed
    thresholds:
      break_zscore: 1.0
      affinity_drop: 0.1

  turbofan:
    description: "CMAPSS Turbofan Engine Degradation"
    signal_prefix: "CMAPSS_"
    fault_signal: "CMAPSS_RUL"  # Remaining Useful Life
    exclude_pattern: "RUL"

    # Turbofan-specific settings
    windows:
      pre_onset: 30       # Longer window for gradual degradation
      post_onset: 10

    thresholds:
      break_zscore: 0.8   # More sensitive for gradual degradation
      affinity_drop: 0.05

  # Template for new domains
  _template:
    description: "Domain description"
    signal_prefix: "PREFIX_"
    fault_signal: "PREFIX_LABEL"
    exclude_pattern: "LABEL"

    # Optional overrides
    windows: {}
    thresholds: {}
    precursor_signals: []
